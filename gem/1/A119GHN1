ç™¼ä¿¡äºº: chwaian.bbs@processor.tfcis.org (ç„¡è¨€) çœ‹æ¿: Maple_itoc
æ¨™  é¡Œ: [åŠŸèƒ½]æ–°èæ¨™é¡Œæ”¾åˆ°å‹•æ…‹çœ‹æ¿
ç™¼ä¿¡ç«™: å‹•åŠ›æ ¸å¿ƒ (04/26/04 16:54:39 Mon)                  Updated: 2004/04/26

  è¦å…ˆåšç²¾è¯å€é€™ç¯‡
  [åŠŸèƒ½] enews-open.c å¥‡æ‘©æ–°èè½‰è‡³çœ‹æ¿


ideaå¾WDçš„cnaè€Œä¾†

ä¸éå¾Œä¾†æˆ‘ç™¼ç¾é€™å€‹åŠŸèƒ½ è¦åœ¨itocçš„ç‰ˆæœ¬ä¸Šå¯¦ç¾

é‚„è »å®¹æ˜“çš„ å› ç‚ºitocçš„ç‰ˆæœ¬æœ¬ä¾†å°±æœ‰æŠ“æ–°èçš„åŠŸèƒ½

åªè¦å¾èˆŠæœ‰ç¨‹å¼ æ‹¿å‡ºä¾†ç”¨å³å¯

: crontab -e åŠ å…¥é€™ä¸€è¡Œ

20 * * * * bin/cna > /dev/null 2>&1

: src/util/Makefile

EXE =   ..... [1;33mcna[m

: src/util/cna.c æ–°å¢é€™ç¨‹å¼

/*-------------------------------------------------------*/
/* cna.c    ( NTHU CS MapleBBS Ver 3.10 )                */
/*-------------------------------------------------------*/
/* target : æ–°èæ¨™é¡Œæ”¾åˆ°å‹•æ…‹çœ‹æ¿                         */
/* create : 02/01/27                                     */
/* update :   /  /                                       */
/* author : chwaian.bbs@processor.tfcis.org              */
/*-------------------------------------------------------*/


#include "bbs.h"


#define MAX_ENEWS   16

static char title[MAX_ENEWS][TTLEN + 1];    /* æœ¬åˆ†é¡æ–°èçš„æ‰€æœ‰æ¨™é¡Œ */


static void
enews_fpath(fpath, kind, fname)
  char *fpath;
  char kind;
  char *fname;
{
  sprintf(fpath, "run/kimo/%c/%s", kind, fname);
}


int
main()
{
  char kind;
  char fpath[64];
  char class[12][5] =
  {
    "æ”¿æ²»", "ç¤¾æœƒ", "åœ‹éš›", "å…©å²¸", "è²¡ç¶“", "å½±è¦–",
    "é«”è‚²", "ç”Ÿæ´»", "ä¼‘é–’", "å¥åº·", "ç§‘æŠ€", "æ–°å¥‡"
  };
  [1;44m// å…ˆåœ¨ note ç²¾è¯å€çš„å‹•æ…‹çœ‹æ¿æ–°å¢åäºŒç¯‡æ–‡ç« ï¼Œä¸¦æŒ‰ S å¾—çŸ¥æª”æ¡ˆåç¨±ï¼ŒæŠ„ä¾†é€™è£¡ [m
  char filename[12][11] =
  {
    "5/A108NLL5", "L/A108NLLL", "A/A108NLMA", "M/A108NLMM",
    "3/A108NLN3", "G/A108NLNG", "S/A108NLNS", "6/A108NLO6",
    "H/A108NLOH", "S/A108NLOS", "7/A108NLP7", "J/A108NLPJ"
  };

  FILE *fp, *fp2;
  ENEWS enews;
  struct tm *ptime;
  time_t now;
  int color, i, j;

  chdir(BBSHOME);

  for (kind = 'A'; kind <= 'L'; kind++)
  {
    color = 1;
    j = 0;

    enews_fpath(fpath, kind, ".ENEWS");

    if (!(fp = fopen(fpath, "r")))
      return;

    while (fread(&enews, sizeof(ENEWS), 1, fp) == 1 && j < MAX_ENEWS)
    {
      strcpy(title[j], enews.title);
      j++;
    }

    sprintf(fpath, "gem/brd/%s/%s", BN_CAMERA, filename[kind - 'A']);

    if ((fp2 = fopen(fpath, "w+")) != NULL)
    {
      time(&now);

      i = now % 8 ;

      ptime = localtime(&now);
      fprintf(fp2, "\033[1;37mâ—‡\033[36mâ”€â”€\033[33;41må¥‡æ‘©æ–°èå¿«å ±"
        "\033[36;40mâ”€â”€ä»Šæ—¥\033[37m%s\033[36mé¡æ–°èâ”€â”€â”€â”€â”€\033[31m"
        "æœ€å¾Œæ›´æ–°æ™‚é–“:\033[37m%02d/%02d %02d:%02d\033[36mâ”€\033[37mâ—‡\033[m\n",
        class[kind - 'A'], ptime->tm_mon + 1,ptime->tm_mday,
        ptime->tm_hour, ptime->tm_min);

      for(j = 0 ; j < 9 ; j++)
      {
        fprintf(fp2, "\033[1;3%dm  %d  %s\033[m\n", color, j + 1, title[i]);
        color = ((color+1)%7) + 1 ;
        i++ ;
      }

      fprintf(fp2,"\033[1;37mâ—‡\033[36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
        "\033[33;42mæ¬²çŸ¥è©³ç´°æ–°èå…§å®¹,è«‹è¦‹ \033[36m%s \033[33mæ¿\033[36;40mâ”€"
        "\033[37mâ—‡\033[m\n",
        "Kimo_News");
      fclose(fp2);
    }

    fclose(fp);
  }

  return 0;
}



å°±æœƒåœ¨å‹•æ…‹çœ‹æ¿ä¸Šshowå‡ºæ–°èæ¨™é¡Œ


[m[1mâ—‡[36mâ”€â”€[33;41må¥‡æ‘©æ–°èå¿«å ±[36;40mâ”€â”€ä»Šæ—¥[37mé«”è‚²[36mé¡æ–°èâ”€â”€â”€â”€â”€[31mæœ€å¾Œæ›´æ–°æ™‚é–“:[37m04/26 16:45[36mâ”€[37mâ—‡[m
[1;31m  1  BALCOæ‰¿èªæä¾›ç¦è—¥çµ¦é‚¦æ–¯[m
[1;33m  2  è‹±è¶…-é˜¿æ£®ç´å°„æ‰‹äº¨åˆ©é€£çºŒç¬¬äºŒå¹´ç•¶é¸PFAå¹´åº¦æœ€ä½³çƒå“¡[m
[1;35m  3  æ„ç”²-ä¸€çƒè¿·åœ¨åœ‹ç±³è³½å¾Œå¾è–è¥¿ç¾…çƒå ´ä¸‰å±¤çœ‹å°è·Œè½èº«äº¡[m
[1m  4  NBA-å¸•å…‹ç™¼å¨ç‡é¦¬åˆº4-0æ·˜æ±°ç°ç†Š,ç‡å…ˆèº‹èº«è¥¿éƒ¨è¯ç›Ÿå››å¼·[m
[1;32m  5  NBAã€‹é¦¬é¾å¿«é30åˆ† æ¹–äººè½ç‰Œ[m
[1;34m  6  NBAã€‹ç±ƒç¶²ã€æºœé¦¬ã€é¦¬å‰Œ ç›´è½å››æ™‰äºŒè¼ª[m
[1;36m  7  NBAã€‹å¹´åº¦ç¬¬ä¸€éšŠ é„§è‚¯é€£ä¸ƒä¸Šæ¦œ[m
[1;31m  8  æ—…ç¾çƒæ˜Ÿã€‹ä¸ƒå±€10Kç„¡å¤±åˆ† ç‹å»ºæ°‘é¦–å‹[m
[1;33m  9  NBA-é¦¬ä¸ã€åŸºå¾·å‹¢ä¸å¯ç•¶,ç±ƒç¶²4-0æ©«æƒå°¼å…‹æ™‰ç´šæ±éƒ¨æº–æ±ºè³½[m
[1mâ—‡[36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[33;42mæ¬²çŸ¥è©³ç´°æ–°èå…§å®¹,è«‹è¦‹ [36mKimo_News [33mæ¿[36;40mâ”€[37mâ—‡[m

--
 [1;43mâ•­[46mâ”¼[m Or[1mig[30min[m: [41m Maple-itocË™å‹•åŠ›æ ¸å¿ƒ [32;47m processor.tfcis.org [m
 [1;44mâ”¼[41mâ•¯[m A[1mut[30mho[mr: [1;33mchwaian [30må¾ [35m61-216-218-91.dynamic.hinet.net [30mç™¼è¡¨[m
