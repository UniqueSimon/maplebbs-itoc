ç™¼ä¿¡äºº: itoc.bbs@cpu.tfcis.org (æ ¸å¿ƒå‹•åŠ›) çœ‹æ¿: plan
æ¨™  é¡Œ: æ‹’æ”¶ç«™å¤–ä¿¡ä»¶
ç™¼ä¿¡ç«™: å‹•åŠ›æ ¸å¿ƒ (2006/04/06 Thu 12:33:53)                Updated: 2006/05/17

â€» å¼•è¿°ã€Šguessi.bbs@bbs.wretch.ccã€‹ä¹‹éŠ˜è¨€ï¼š
> è¨˜å¾—ä»¥å‰æœ‰é€™function
> è«‹å•è¦æ€éº¼æ”¹ ? è®“ä½¿ç”¨è€…è‡ªè¨‚æ˜¯å¦æ”¶å–ç«™å¤–ä¿¡ä»¶
> å»£å‘Šä¿¡æ“‹ä¸å®Œ ä½†æœ‰äº›äººåªæ˜¯æ”¶ç«™å…§ä¿¡ ä¸æƒ³æ”¶ç«™å¤–ä¿¡ä»¶
> è«‹å•è©²æ€éº¼åšä¿®æ”¹ ? (å¸Œæœ›èƒ½åšæˆå–œå¥½è¨­å®š)

: ufo.h

- #define UFO_NOUSE20     BFLAG(20)
+ #define UFO_NOINCOME    BFLAG(20)

: ufo.h

- #define NUMUFOS_USER    20      /* ä¸€èˆ¬ä½¿ç”¨è€… å¯ä»¥ç”¨å‰ 20 å€‹ ufo */
+ #define NUMUFOS_USER    21      /* ä¸€èˆ¬ä½¿ç”¨è€… å¯ä»¥ç”¨å‰ 21 å€‹ ufo */

- #define STR_UFO         "-mpsnemPBQFANbwtSH-J----CHA"
+ #define STR_UFO         "-mpsnemPBQFANbwtSH-JM---CHA"

: ufo.h

- "ä¿ç•™",
+ "æ‹’æ”¶ç«™å¤–ä¿¡ä»¶    (ä¸æ”¶/è¦æ”¶)",    /* UFO_NOINCOME */

: bmtad.c:is_rcpt()

    if (!str_cmp(str, ".bbs"))
    {
      if (len <= IDLEN + 4)
      {
+       ACCT acct;

        *str = '\0';
        str_lower(rcpt, rcpt);
        sprintf(fpath, "usr/%c/%s/@", *rcpt, rcpt);
+       if ((len = acct_fetch(rcpt, &acct)) >= 0)
+       {
+         close(len);
+         if (acct.ufo & UFO_NOINCOME)
+           return -1;
+       }
        if (dashd(fpath))
        {
          *letter = 1;
          return 0;
        }
      }
    }

: bbsmail.c:mail2bbs()

  int fd;
  FILE *fp;
+ ACCT acct;

+ usr_fpath(folder, userid, FN_ACCT);
+ if ((fd = open(folder, O_RDONLY)) >= 0)
+ {
+   read(fd, &acct, sizeof(ACCT));
+   close(fd);
+   if (acct.ufo & UFO_NOINCOME)
+   {
+     sprintf(buf, "BBS user <%s> no income mail", userid);
+     mailog(buf);
+     return EX_NOUSER;
+   }
+ }

--
[1;36m=[37m[[36mï¹[37m:[33m?[37mæ‘ƒ?[mâ—£?[1;33m?[37m:[36mï¹ [31mOrigin[37m ]|[[m  [0;31m?[1m?[1m?[0;31mO[0;31m?[1m?[1m?[0;31m?[1mcpu.tfcis.org  [37m]|[?[33mæŸèªª[m?[1;36mï¹[37m:][36m=[m
[1;36m=[0m[[1;36mï¹Š[37m:[33m?[30mæ‘ƒ?[mâ•±?[1;33m?[37m:[36mï¹Š [31mAuthor[m ]|[[1m  pc512-1.ee.nctu.edu.tw  [m]|[?[1;33m?[30m?[37mæ’[30m?[36mï¹Š[37m:[m][1;36m=[m
