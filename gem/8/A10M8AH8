ç™¼ä¿¡äºº: itoc.bbs@processor.tfcis.org (æ ¸å¿ƒå‹•åŠ›) çœ‹æ¿: plan
æ¨™  é¡Œ: Re: æƒ³è¦ä¸€å€‹ç¨‹å¼...
ç™¼ä¿¡ç«™: å‹•åŠ›æ ¸å¿ƒ (2004/10/06 Wed 23:24:46)                Updated: 2005/06/12

â€» å¼•è¿°ã€ŠFrank.bbs@cpp.twbbs.org (è²è²)ã€‹ä¹‹éŠ˜è¨€ï¼š
> check å¦‚æœ .BRD è£¡æœ‰ä»»ä½•ä¸€å€‹çœ‹æ¿,æ²’æœ‰å‡ºç¾åœ¨ newsfeeds.bbs ä¸­

: src/util/Makefile åŠ å…¥ check_newsfeeds

EXE =   account acl-sort bbsmail [1;33mcheck_newsfeeds[m ...

: src/util/check_newsfeeds.c æ–°å¢ç¨‹å¼å¦‚ä¸‹

/*-------------------------------------------------------*/
/* util/check_newsfeeds.c  ( NTHU CS MapleBBS Ver 3.10 ) */
/*-------------------------------------------------------*/
/* target : æª¢æŸ¥ newsfeeds.bbs æ˜¯å¦æœ‰ä¸è½‰ä¿¡çš„çœ‹æ¿        */
/* create : 04/10/06                                     */
/* update :   /  /                                       */
/* author : itoc.bbs@bbs.tnfsh.tn.edu.tw                 */
/*-------------------------------------------------------*/


#include "bbs.h"


static int              /* 1: brdname åœ¨ newsfeeds.bbs å…§ */
in_newsfeeds(brdname)
  char *brdname;
{
  newsfeeds_t nf;
  int fd;
  int rc = 0;

  if ((fd = open("innd/newsfeeds.bbs", O_RDONLY)) >= 0)
  {
    while (read(fd, &nf, sizeof(newsfeeds_t)) == sizeof(newsfeeds_t))
    {
      if (!strcmp(nf.board, brdname))
      {
        rc = 1;
        break;
      }
    }
    close(fd);
  }
  return rc;
}


int
main()
{
  BRD brd;
  int fd;
  char *str;

  chdir(BBSHOME);

  if ((fd = open(FN_BRD, O_RDONLY)) >= 0)
  {
    while (read(fd, &brd, sizeof(BRD)) == sizeof(BRD))
    {
      str = brd.brdname;

      if (!*str)  /* æ­¤æ¿å·²è¢«åˆªé™¤ */
        continue;

      if (!(brd.battr & BRD_NOTRAN) && !in_newsfeeds(str))
        printf("%s çš„å±¬æ€§è¦è½‰ä¿¡å‡ºå»ï¼Œä½†ä¸åœ¨ newsfeeds.bbs ä¸­\n", str);
    }
    close(fd);
  }

  return 0;
}

--
 [1;41mâ•­[44mâ”¼[m Or[1mig[30min[m: [43m Maple-itocË™å‹•åŠ›æ ¸å¿ƒ [35;47m processor.tfcis.org [m
 [1;43mâ•°[46mâ•–[m [1mMo[30mdi[mfy: [1;35m2004/10/06 Wed 23:24:46[m
