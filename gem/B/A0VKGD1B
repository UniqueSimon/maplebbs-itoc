ä½œè€…: itoc (å¯«ä¸å®Œäº† ^^) çœ‹æ¿: plan
æ¨™é¡Œ: [åŠŸèƒ½] ç·¨è¼¯æ–‡ç« æ™‚æœå°‹å­—ä¸²
æ™‚é–“: Sat Aug 23 20:59:41 2003                          Updated: 2003/08/23

â€» å¼•è¿°ã€Šcpd.bbs@pitch.twbbs.org (Seasons)ã€‹ä¹‹éŠ˜è¨€ï¼š
> å°±æ˜¯åœ¨ç·¨è¼¯æ–‡ç« çš„æ™‚å€™...ä¸çŸ¥é“mapleæœ‰æ²’æœ‰å°‹æ‰¾å­—ä¸²çš„åŠŸèƒ½å‘¢ï¼Ÿ
> åƒjoeä¸€æ¨£ï¼ŒæŒ‰ ^kf æˆ– Esc + s å°±èƒ½å°‹æ‰¾å­—ä¸²...
> åƒä¸€ç¯‡æ–‡ç« å¾ˆé•·çš„æ™‚å€™ï¼Œå°±å¯ä»¥æŒ‰Eä¾†ç·¨è¼¯æœå°‹è¦æ‰¾çš„å­—ä¸²...

  ç”±æ–¼ edit æ™‚çš„æŒ‰éµ Ctrl+? éƒ½æœ‰åŠŸèƒ½ä½”åŽ»äº†
  æ‰€ä»¥è¦å…ˆæŠ“å‡ºä¸€å€‹æŒ‰éµï¼Œåœ¨æ­¤ä»¥ Ctrl('B') åšä¾‹å­
  ä½ ä¹Ÿå¯ä»¥è‡ªå·±é¸åˆ¥çš„éµ

: edit.c:vedit() ç”±æ–¼ Ctrl('B') å¯ä»¥ç”¨ KEY_PGUP å–ä»£
:                æ‰€ä»¥æŠŠ Ctrl('B') é‡‹æ”¾å‡ºä¾†çµ¦åˆ¥çš„åŠŸèƒ½ç”¨

int             /* -1:å–æ¶ˆç·¨è¼¯ 0:å®Œæˆç·¨è¼¯ */
vedit(fpath, ve_op)
  char *fpath;
  int ve_op; /* 0:ç´”ç²¹ç·¨è¼¯æª”æ¡ˆ  -1:ç·¨è¼¯ä½†ä¸èƒ½å„²å­˜  1:quote/header  2:quote */
{
  textline *vln, *tmp;
  int cc, col, mode, margin, pos;
+ char hunt[32];

  /* --------------------------------------------------- */
  /* åˆå§‹è¨­å®šï¼šè¼‰å…¥æª”æ¡ˆã€å¼•ç”¨æ–‡ç« ã€è¨­å®šç·¨è¼¯æ¨¡å¼          */
  /* --------------------------------------------------- */

+ hunt[0] = '\0';
  tmp = vln = ve_alloc();

  ...
  ...

      case KEY_PGUP:
-     case Ctrl('B'):

        ve_pageup();
        continue;

   ...
   ...

+     case Ctrl('B'):
+
+       if (vget(b_lines, 0, "æœå°‹ï¼š", hunt, sizeof(hunt), GCARRY))
+       {
+         if (!ve_search(hunt))
+         {
+           vmsg("æ‰¾ä¸åˆ°æ‚¨æƒ³æœå°‹çš„å­—ä¸²");
+           ve_mode = mode | VE_FOOTER;
+         }
+       }
+       continue;

      default:

        goto ve_key;
      }

: edit.c:ve_search() æ–°å¢žæ­¤å‡½å¼æ–¼ ve_goto() å¾Œé¢

static inline int
ve_search(hunt)
  char *hunt;
{
  textline *cur, *top, *tmp;
  uschar *str, *pend;
  int len, find;

  len = strlen(hunt);
  find = 0;

  for (cur = vx_cur; cur; cur = cur->next)   /* å¾€ä¸‹æœå°‹ */
  {
    str = cur->data + (cur == vx_cur ? ve_col + 1: 0);
    pend = str + cur->len - len + 1;

    while (str < pend)
    {
      if (!str_ncmp(str, hunt, len))
      {
        ve_col = str - cur->data;
        find = 1;
        goto find_hunt;
      }
      str++;
    }
  }

find_hunt:

  if (find)
  {
    top = cur;

    for (len = 0; len < 10; len++)
    {
      if (!(tmp = top->prev))
        break;
      top = tmp;
    }

    vx_cur = cur;
    vx_top = top;
    ve_lno = len;

    ve_position(cur, top);
  }

  return find;
}

--
[1;37mâ–¡ æœ¬æ–‡ç« ç”± [33mitoc[37m å¾ž [32mitoc.Dorm11.NCTU.edu.tw[37m ç™¼è¡¨[m
