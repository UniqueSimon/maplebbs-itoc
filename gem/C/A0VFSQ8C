ç™¼ä¿¡äºº: itoc.bbs@processor.tfcis.org (1999 Commencement) çœ‹æ¿: plan
æ¨™  é¡Œ: Re: [åŠŸèƒ½] æ°´çƒç³»çµ±
ç™¼ä¿¡ç«™: XEON (Sat, 28 Jun 2003 09:12:00 +0800 (CST))      Updated: 2005/03/09

â€» å¼•è¿°ã€ŠFrequency (é »ç‡)ã€‹ä¹‹éŠ˜è¨€ï¼š
> è€Œæ˜¯æ”¹æˆ...å¦‚æœæˆ‘å›äº†bmw_posç›®å‰çš„æ°´çƒ...
> ä¸‹ä¸€æ¬¡call bmw_display()æ™‚...æ˜Ÿè™Ÿæœƒè®Šæˆ"Ë‡"...
> ä¹Ÿå°±æ˜¯èªª...å›éçš„æ°´çƒæœƒè®Šæˆæ‰“å‹¾...

: struct.h   // æŠ“ 1-bit çµ¦ replied

typedef struct
{
  time_t btime;
  UTMP *caller;                 /* who call-in me ? */
  int sender;                   /* calling userno */
  int recver;                   /* called userno */
  char userid[IDLEN + 1 + 2];   /* itoc.010529: ä¿ç•™ 2 byte çµ¦å»£æ’­ç¬¦è™Ÿ > */
- char msg[69];                 /* æ°´çƒ */
+ char msg[68];                 /* æ°´çƒ */
+ char replied;                 /* 1: å·²å›æ°´çƒ */
}      BMW;                     /* bbs message write */

: bmw.c:bmw_edit()

  if (vans(fpath) != 'n')
  {
    int i;

+   if (bbsmode == M_BMW_REPLY)
+   {
+     BMW *benz;
+
+     /* ^R å›éçš„æ°´çƒæ¨™è¨˜å·²å› */
+     benz = &bmw_lslot[bmw_pos];
+     benz->replied = 1;
+   }

    bmw->caller = cutmp;
    bmw->sender = cuser.userno;
    strcpy(bmw->userid, userid = cuser.userid);

    ...
    ...

+   bmw->replied = 0;
    time(&bmw->btime);
    usr_fpath(fpath, userid, fn_bmw);
    rec_add(fpath, bmw, sizeof(BMW));

: bmw.c  ç‰ˆé¢è‡ªè¡Œèª¿æ•´

#define BMW_FORMAT  "\033[1;33;46mâ˜…%s \033[37;45m %s \033[m" /* æ”¶åˆ°çš„æ°´çƒ */
#define BMW_FORMAT2 "\033[1;33;41mâ˜†%s \033[34;47m %s \033[m" /* é€å‡ºçš„æ°´çƒ */
+ #define BMW_FORMAT4 "\033[1;33;46mË‡%s \033[37;45m %s \033[m" /* å·²å›è¦† */

: bmw.c:bmw_display()

  for (; max >= 0; max--)
  {     /* å¾è¼ƒæ–°çš„æ°´çƒå¾€ä¸‹å° */
    bmw = &bmw_lslot[max];
    move(i, 0);
    clrtoeol();
-   prints("  " BMW_FORMAT, bmw->userid, bmw->msg);
+   prints(bmw->replied ? "  " BMW_FORMAT4 : "  " BMW_FORMAT,
+     bmw->userid, bmw->msg);
    i++;
  }

--
[1;36m=[37m[[36mï¹[37m:[33m?[37mæ‘ƒ?[mâ—£?[1;33m?[37m:[36mï¹ [31mOrigin[37m ]|[[m     [31m?[1må¨[0;31mO?[1mç—[0;31m?[1mprocessor.tfcis.org    [37m]|[?[33mæŸèªª[m?[1;36mï¹[37m:][36m=[m
[1;36m=[m[[1;36mï¹Š[37m:[33m?[30mæ‘ƒ?[mâ•±?[1;33m?[37m:[36mï¹Š [31mAuthor[m ]|[ [1m      itoc.Dorm11.NCTU.edu.tw       [m]|[?[1;33m?[30m?[37mæ’[30m?[36mï¹Š[37m:[m][1;36m=[m
