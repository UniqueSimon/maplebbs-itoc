ç™¼ä¿¡äºº: itoc.bbs@cpu.tfcis.org (æ ¸å¿ƒå‹•åŠ›) çœ‹æ¿: plan
æ¨™  é¡Œ: Re: è«‹å•ç‰ˆå‹åœç•™æ™‚é–“
ç™¼ä¿¡ç«™: å‹•åŠ›æ ¸å¿ƒ (2007/05/12 Sat 09:04:41)                Updated: 2007/05/18

â€» å¼•è¿°ã€Šmaya (ç‘ªé›…)ã€‹ä¹‹éŠ˜è¨€ï¼š
> æˆ‘æƒ³è¦æ¯å€‹ç‰ˆä¸»éƒ½èƒ½å¤ çœ‹åˆ°æœ‰å“ªå¹¾å€‹äººå„åœç•™å¤šä¹…é€™æ¨£ï¼Œä¹Ÿè¨±æ˜¯
> F7   2007/05/11 13:32:33 åœç•™32ç§’
> in2  2006/04/12 12:24:43 åœç•™10000ç§’
> F7   2005/01/23 23:22:45 åœç•™235ç§’
> é€™æ¨£å­çš„è³‡è¨Š
> ä¹Ÿè¨±åœ¨ç‰ˆå…§ï¼Œç‰ˆä¸»å¤šå€‹å¿«æ·éµå¯ä»¥çœ‹åˆ°é€™æ¨£çš„è³‡è¨Š

: board.c:mantime_add()

  if (outbno >= 0)
+ {
    bshm->mantime[outbno]--;          /* é€€å‡ºä¸Šä¸€å€‹æ¿ */
+   board_usies(outbno, 0);
+ }
  if (inbno >= 0)
+ {
    bshm->mantime[inbno]++;           /* é€²å…¥æ–°çš„æ¿ */
+   board_usies(inbno, 1);
+ }

: board.c:board_usies() æ–°å¢æ­¤å‡½å¼åœ¨ XoPost() å‰é¢

void
board_usies(bno, in)
  int bno;
  int in;
{
  static time_t start;
  time_t now;
  char fpath[64], buf[80];

  if (in)    /* é€²å…¥çœ‹æ¿ï¼Œé–‹å§‹è¨ˆç®—æ™‚é–“ */
  {
    time(&start);
  }
  else       /* é›¢é–‹çœ‹æ¿ï¼Œçµç®—æ™‚é–“ */
  {
    time(&now);
    brd_fpath(fpath, (bshm->bcache + bno)->brdname, "board_usies");
    sprintf(buf, "%s %s åœç•™%dç§’", cuser.userid, Btime(&now), now - start);
    f_cat(fpath, buf);
  }
}

: maple.p

+ void board_usies(int bno, int in);
int XoPost(int bno);

: manage.c:post_board_usies() æ–°å¢æ­¤å‡½å¼æ–¼ post_manage() å‰é¢

static int
post_board_usies(xo)
  XO *xo;
{
  char fpath[64];

  brd_fpath(fpath, currboard, "board_usies");
  more(fpath, NULL);
}

: manage.c:post_manage()

#  ifdef HAVE_SCORE
    "Score   è¨­å®šå¯å¦è©•åˆ†",
#  endif
+   "Log     çœ‹æ¿ä½¿ç”¨è¨˜éŒ„",

  ...
  ...

#  ifdef HAVE_SCORE
    " (S)è©•åˆ†"
#  endif
+   " (L)è¨˜éŒ„"

  ...
  ...

#ifdef HAVE_SCORE
  case 's':
    return post_battr_noscore(xo);
#endif

+ case 'l':
+   return post_board_usies(xo);

--
[1;36m=[37m[[36mï¹[37m:[33m?[37mæ‘ƒ?[mâ—£?[1;33m?[37m:[36mï¹ [31mOrigin[37m ]|[[m  [0;31m?[1m?[1m?[0;31mO[0;31m?[1m?[1m?[0;31m?[1mcpu.tfcis.org  [37m]|[?[33mæŸèªª[m?[1;36mï¹[37m:][36m=[m
[1;36m=[0m[[1;36mï¹Š[37m:[33m?[30mæ‘ƒ?[mâ•±?[1;33m?[37m:[36mï¹Š [31mAuthor[m ]|[[1m218-168-182-38.dynamic.hin[m]|[?[1;33m?[30m?[37mæ’[30m?[36mï¹Š[37m:[m][1;36m=[m
