ä½œè€…: itoc (äº¤å¤§é›»å­) çœ‹æ¿: plan
æ¨™é¡Œ: [åŠŸèƒ½] æ–‡ç« ä¸èƒ½è½‰å¯„
æ™‚é–“: Sun Mar 10 15:11:11 2002                          Updated: 2004/09/07

â€» å¼•è¿°ã€Šelvis (elvis)ã€‹ä¹‹éŠ˜è¨€ï¼š
> >     æˆ‘åœ¨æƒ³å¦‚æœä½¿ç”¨è€…å¯ä»¥è¨­å®šè‡ªå·±çš„æ–‡ç« ä¸å¯è½‰å¯„é‚£ä¹Ÿä¸éŒ¯

: hdr.h

#define POST_NOFORWARD      0x00004000      /* ä¸èƒ½è½‰å¯„çš„ */

: modes.h

#define EDIT_NOFORWARD  0x20    /* ä¸èƒ½è½‰å¯„ */

> >     ä½¿ç”¨è€…å¯ä»¥åœ¨ ctrl-x å¾Œä¸æŒ‰ l ä¹Ÿä¸æŒ‰ s ä¾†å­˜
> >     æŒ‰å¦ä¸€å€‹ä¸å¯è½‰å¯„çš„é¸é …

: post.c do_post()

  title = ve_title;
  mode = (curredit & EDIT_OUTGO) ? POST_OUTGO : 0;
+ if (curredit & EDIT_NOFORWARD)
+   mode |= POST_NOFORWARD;

  ...
  ...

  if (!rec_add(folder, &post, sizeof(HDR)))
  {
-   if (mode)
+   if (curredit & EDIT_OUTGO)
      outgo_post(&post, currboard);

: edit.c ve_filer()

  [1;44m // menu1 menu2 menu3 menu4 ä¹Ÿæ˜¯æ¯”ç…§ä¿®æ”¹ [m

  if (ve_op < 0)        /* itoc.010301: æ–°å¢ ve_op = -1 ä¸èƒ½å„²å­˜ */
-   msg = "[E]ç¹¼çºŒ (A)æ”¾æ£„ ....";
+   msg = "[E]ç¹¼çºŒ (F)ä¸å¾—è½‰å¯„ (A)æ”¾æ£„ ....";
  else if (bbsmode != M_POST)
-   msg = "[S]å­˜æª” (A)æ”¾æ£„ ....";
+   msg = "[S]å­˜æª” (F)ä¸å¾—è½‰å¯„ (A)æ”¾æ£„ ....";
  else if (curredit & EDIT_OUTGO)
-   msg = "[S]å­˜æª” (L)ç«™å…§ (A)æ”¾æ£„ ...";
+   msg = "[S]å­˜æª” (L)ç«™å…§ (F)ä¸å¾—è½‰å¯„ (A)æ”¾æ£„ ...";
  else
-   msg = "[L]ç«™å…§ (S)å­˜æª” (A)æ”¾æ£„ ...";
+   msg = "[L]ç«™å…§ (S)å­˜æª” (F)ä¸å¾—è½‰å¯„ (A)æ”¾æ£„ ...";

  ...
  ...

  case 'l':
    if (ve_op < 0)              /* itoc.010301: ä¸èƒ½å„²å­˜ */
      return VE_FOOTER;
    curredit &= ~EDIT_OUTGO;
    break;

+ case 'f':
+   if (ve_op < 0)              /* itoc.010301: ä¸èƒ½å„²å­˜ */
+     return VE_FOOTER;
+   curredit |= EDIT_NOFORWARD;
+   curredit &= ~EDIT_OUTGO;    /* ä¸èƒ½è½‰å¯„å¿…æ˜¯ local save */
+   break;

  case 'r':
    tbf_read();
    return VE_REDRAW;

: post.c post_cross()

#ifdef HAVE_REFUSEMARK
      if (hdr->xmode & POST_RESTRICT)
        continue;
#endif

+     if (hdr->xmode & POST_NOFORWARD)
+       continue;

      /* hdr_fpath(fpath, xo->dir, hdr); */
      xo_fpath(fpath, dir, hdr);      /* lkchu.981201 */
      brd_fpath(xfolder, xboard, fn_dir);

: xover.c xo_forward()

    /* itoc.000319: ä¿®æ­£é™åˆ¶ç´šæ–‡ç« ä¸å¾—è½‰å¯„ */
    /* itoc.010602: GEM_RESTRICT å’Œ POST_RESTRICT åŒ¹é…ï¼Œæ‰€ä»¥åŠ å¯†æ–‡ç« ä¹Ÿä¸å¾—è½‰å¯„ */
    if ((xmode & (GEM_RESTRICT | GEM_RESERVED)) && !HAS_PERM(PERM_ALLBOARD))
      continue;

+   if (xmode & POST_NOFORWARD)
+      continue;

    if (!(xmode & GEM_FOLDER))          /* æŸ¥ hdr æ˜¯å¦ plain text */


> >     ç„¶å¾Œåœ¨æ–‡ç« åˆ—è¡¨ä¹Ÿå¯ä»¥ cancel æˆ–å†è¨­å®šä¸å¯è½‰å¯„
> >     ç•¶ç„¶è¦ä¸è½‰ä¿¡çš„è©±ä¸€é–‹å§‹çš„ä¸å¯è½‰å¯„ä¹Ÿæœƒå­˜æˆ localsave å›‰

: post.c:post_noforward() æ–°å¢é€™éš»å‡½å¼åœ¨ post_help() ä¹‹å‰

static int
post_noforward(xo)
  XO *xo;
{
  HDR *hdr;
  int pos, cur;

  if (!cuser.userlevel) /* itoc.020114: guest ä¸èƒ½å°å…¶ä»– guest çš„æ–‡ç« åŠ å¯† */
    return XO_NONE;

  pos = xo->pos;
  cur = pos - xo->top;
  hdr = (HDR *) xo_pool + cur;

  if (HAS_PERM(PERM_ALLBOARD) || !strcmp(hdr->owner, cuser.userid))
  {
    hdr->xmode ^= POST_NOFORWARD;

    currchrono = hdr->chrono;
    rec_put(xo->dir, hdr, sizeof(HDR), xo->key == XZ_XPOST ?
      hdr->xid : pos, cmpchrono);
  }

  return XO_NONE;
}

: post.c:post_cb[]
: post.c:xpost_cb[]

+ 'M', post_noforward,      [1;44m// æŒ‰éµè‡ªå®š [m


--
  æˆ‘æ²’è©¦éé€™åŠŸèƒ½ï¼Œä¹Ÿä¸çŸ¥é“æœ‰æ²’æœ‰æ¼æ´ :p

  ä¸éä¸èƒ½è½‰å¯„çš„æ–‡ç« ä¸æ˜¯å¾ˆå¥‡æ€ªå—?
  æ—¢ç„¶èƒ½è¢«åˆ¥äººçœ‹åˆ°, ä»–å°±å¯ä»¥ä»»æ„ copy äº†å•Š

--
[1;37mâ–¡ æœ¬æ–‡ç« ç”± [33mitoc[37m å¾ [32mnctu5566.Dorm3.NCTU.edu.tw[37m ç™¼è¡¨[m
