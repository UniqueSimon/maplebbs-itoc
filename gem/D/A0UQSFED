ä½œè€…: itoc (æ‹¯æ•‘ä¸€å€‹éˆé­‚) çœ‹æ¿: plan
æ¨™é¡Œ: Re: è«‹å•ä¸€ä¸‹  ç«™é•·çš„åŠŸèƒ½
æ™‚é–“: Tue Jul 30 00:17:47 2002                          Updated: 2003/12/13

â€» å¼•è¿°ã€Štbp (tbp)ã€‹ä¹‹éŠ˜è¨€ï¼š
> å¦‚æœæˆ‘æƒ³è®“ç«™é•·åœ¨æŸ¥è©¢ä½¿ç”¨è€…æ™‚
> æŒ‰Spaceå°±ç›´æ¥é¡¯ç¤ºå‡ºæ‰€æœ‰ä½¿ç”¨è€…
> ä¸ç”¨è¼¸å…¥é¦–å­—æ¯
> è«‹å•é€™æ¨£æ€éº¼æ”¹å‘¢

: visio.c:vget_match()

  else if (op & GET_USER)
  {
    struct dirent *de;
    DIR *dirp;
    int cc;
+   int cd;
    char fpath[16];

-   if (len == 0)
-     return 0;

+   if (len)
+   {
      cc = *prefix;
      if (cc >= 'A' && cc <= 'Z') /* æ›æˆå°å¯« */
        cc |= 0x20;
      if (cc < 'a' || cc > 'z')
        return 0;
+     cd = cc;
+   }
+   else
+   {
+     if (!HAS_PERM(PERM_ALLACCT))  /* ä¸€èˆ¬ä½¿ç”¨è€…è¦è¼¸å…¥ä¸€å­—æ‰æ¯”å° */
+       return 0;
+     cc = 'a';
+     cd = 'z';
+   }

+   for (; cc <= cd; cc++)
+   {
      sprintf(fpath, "usr/%c", cc);
      dirp = opendir(fpath);
      while (de = readdir(dirp))
      {
        data = de->d_name;
+       if (*data <= ' ' || *data == '.')
+         continue;

-       if (str_ncmp(prefix, data, len))
+       if (len && str_ncmp(prefix, data, len))
          continue;

        if (!match++)
        {
          match_title();
          strcpy(hit = fpath, data);      /* ç¬¬ä¸€ç­†ç¬¦åˆçš„è³‡æ–™ */
        }

        move(row, col);
        outs(data);
        col += IDLEN + 1;

        if (col >= SCR_WIDTH - IDLEN - 1)
        {
          col = 0;
          if (++row >= b_lines)
          {
            if (match_getch())
+           {
+             cc = 'z';     /* é›¢é–‹ for è¿´åœˆ */
              break;
+           }
            row = 3;
          }
        }
      }

      closedir(dirp);
    }
+ }
  else /* Thor.990203.è¨»è§£: GET_LIST */

--
[1;37mâ–¡ æœ¬æ–‡ç« ç”± [33mitoc[37m å¾ [32mitoc.Dorm-GD2.NCTU.edu.tw[37m ç™¼è¡¨[m
