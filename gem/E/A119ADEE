ç™¼ä¿¡äºº: itoc.bbs@cpu.tfcis.org (æ ¸å¿ƒå‹•åŠ›) çœ‹æ¿: plan
æ¨™  é¡Œ: Re: [è«‹æ•™]æœ‰é—œä¸èƒ½ç™¼æ–‡
ç™¼ä¿¡ç«™: å‹•åŠ›æ ¸å¿ƒ (2005/05/26 Thu 02:06:24)                Updated: 2005/05/26

â€» å¼•è¿°ã€Šhatvito.bbs@cpu.tfcis.org (123)ã€‹ä¹‹éŠ˜è¨€ï¼š
> å¦‚æœèªª
> æƒ³è¦è®“æ¿ä¸»è‡ªè¨‚èƒ½ä¸èƒ½ç™¼æ–‡
> è­¬å¦‚èªª
> æœ‰å¤§æ‰¹é„‰æ°‘é¬§æ¿
> æ¿ä¸»ä¾†ä¸åŠè™•ç†
> æƒ³è¦å…ˆåœæ­¢ç™¼æ–‡ä¾†æ•´ç†æ¿é¢

: battr.h

#define BRD_ANONYMOUS   0x20    /* åŒ¿åçœ‹æ¿ */
+ #define BRD_NOPOST    0x40    /* ä¸èƒ½ç™¼è¡¨æ–‡ç« åˆ°çœ‹æ¿ */

  ...
  ...

- #define NUMBATTRS       6
+ #define NUMBATTRS       7

- #define STR_BATTR       "zTcsvA"
+ #define STR_BATTR       "zTcsvAp"

: battr.h:battr_tbl[]

  "åŒ¿åçœ‹æ¿",           /* BRD_ANONYMOUS */
+ "ä¸èƒ½ç™¼è¡¨æ–‡ç« åˆ°çœ‹æ¿", /* BRD_NOPOST */

: post.c:do_post()

+ if (currbattr & BRD_NOPOST)
+   return XO_NONE;

  if (!(bbstate & STAT_POST))

> â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ <

  å¦‚æœå¸Œæœ›é–‹æ”¾çµ¦æ¿ä¸»è‡ªè¡Œè¨­å®š

: manage.c æŠŠä»¥ä¸‹é€™æ®µåŠ åœ¨ post_battr_noscore() å¾Œé¢

static int
post_battr_nopost(xo)
  XO *xo;
{
  BRD *oldbrd, newbrd;

  oldbrd = bshm->bcache + currbno;
  memcpy(&newbrd, oldbrd, sizeof(BRD));

  switch (vans("1)å¯ä»¥åˆªé™¤æ–‡ç«  2)ä¸å¯åˆªé™¤æ–‡ç«  [Q] "))
  {
  case '1':
    newbrd.battr &= ~BRD_NOPOST;
    break;
  case '2':
    newbrd.battr |= BRD_NOPOST;
    break;
  default:
    return XO_FOOT;
  }

  if (memcmp(&newbrd, oldbrd, sizeof(BRD)) && vans(msg_sure_ny) == 'y')
  {
    memcpy(oldbrd, &newbrd, sizeof(BRD));
    rec_put(FN_BRD, &newbrd, sizeof(BRD), currbno, NULL);
  }

  return XO_FOOT;
}

: manage.c:post_manage()

#  ifdef HAVE_SCORE
    "Score   è¨­å®šå¯å¦è©•åˆ†",
#  endif
+   "Post    ç™¼è¡¨æ–‡ç« è¨­å®š",

  ...
  ...

#  ifdef HAVE_SCORE
    " (S)è©•åˆ†"
#  endif
+   " (P)ç™¼æ–‡"

  ...
  ...

#ifdef HAVE_SCORE
  case 's':
    return post_battr_noscore(xo);
#endif

+ case 'p':
+   return post_battr_nopost(xo);

--
 [1;43mâ—¤[46mâ—¥[m Or[1mig[30min[m: [41m Maple-itocË™å‹•åŠ›æ ¸å¿ƒ [36;47m cpu.tfcis.org [m
 [1;44mâ—£[41mâ—¢[m A[1mut[30mho[mr: [1;33mitoc [30må¾ [31mitoc.Dorm11.NCTU.edu.tw [30mç™¼è¡¨[m
