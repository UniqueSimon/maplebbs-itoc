ç™¼ä¿¡äºº: itoc.bbs@cpu.tfcis.org (æ ¸å¿ƒå‹•åŠ›) çœ‹æ¿: plan
æ¨™  é¡Œ: [åŠŸèƒ½] ç›¸åŒ IP çš„ä½¿ç”¨è€…é€²å…¥çœ‹æ¿ä¸è¨ˆç®—çœ‹æ¿äººæ°£
ç™¼ä¿¡ç«™: å‹•åŠ›æ ¸å¿ƒ (2007/05/15 Tue 08:21:49)                Updated: 2007/05/15

â€» å¼•è¿°ã€Šroga (ä»»æ€§)ã€‹ä¹‹éŠ˜è¨€ï¼š
>     è«‹å•æ¿ä¸Šçš„å‰è¼©ï¼Œçœ‹æ¿äººæ°£çš„éƒ¨ä»½æœ€è¿‘é¢è‡¨äº†è¢«çŒæ°´çš„å•é¡Œï¼Œ
>     ä¸»è¦å…·é«”ç‹€æ³æ˜¯æœ‰äººé–‹å¾ˆå¤šåˆ†èº«ï¼Œç„¶å¾ŒçŒåŒä¸€å€‹ç‰ˆçš„äººæ°£ï¼Œ
>     ç›®çš„æ˜¯è®“çœ‹æ¿æ“ ä¸Šç†±é–€æ’è¡Œã€‚
>     æˆ‘éœ€è¦ä¸€äº›è¾¦æ³•ä¾†éæ­¢æ­¤ç¨®è¡Œç‚ºï¼Œç›®å‰æƒ³åˆ°çš„å¤§æ¦‚æ˜¯
>     åŒä¸€å€‹ fromhost ä¸ç´¯ç©äººæ°£ï¼Œ

  é€²ç«™æ™‚æª¢æŸ¥æ˜¯å¦æœ‰äººå’Œè‡ªå·±ä¾†è‡ªåŒä¸€å€‹ä¾†æº
  è‹¥æœ‰ï¼Œé€²å‡ºçœ‹æ¿ä¸å¢æ¸›äººæ°£

: global.h

VAR int total_user;
+ VAR int same_addr;

: bbsd.c:tn_login()

  bbstate = STAT_STARTED;
  utmp_setup(M_LOGIN);
+ same_addr = utmp_same_addr();

: bbsd.c:utmp_find() æ–°å¢æ­¤å‡½å¼åœ¨ utmp_setup() å¾Œé¢

static int
utmp_same_addr()
{
  UTMP *uentp, *uceil;
  int num;

  num = 0;
  uentp = ushm->uslot;
  uceil = (void *) uentp + ushm->offset;
  do
  {
    if (uentp->in_addr == cutmp->in_addr)
      num++;
  } while (++uentp <= uceil);

  return num;
}

: board.c:mantime_add()

+ if (same_addr)        /* æœ‰äººå’Œæˆ‘ç›¸åŒä¾†æºï¼Œæ•…æˆ‘é€²å‡ºçœ‹æ¿ä¸è¨ˆç®—äººæ°£ */
+   return;

  if (outbno >= 0)
    bshm->mantime[outbno]--;          /* é€€å‡ºä¸Šä¸€å€‹æ¿ */
  if (inbno >= 0)
    bshm->mantime[inbno]++;           /* é€²å…¥æ–°çš„æ¿ */

--
[1;36m=[37m[[36mï¹[37m:[33m?[37mæ‘ƒ?[mâ—£?[1;33m?[37m:[36mï¹ [31mOrigin[37m ]|[[m  [0;31m?[1m?[1m?[0;31mO[0;31m?[1m?[1m?[0;31m?[1mcpu.tfcis.org  [37m]|[?[33mæŸèªª[m?[1;36mï¹[37m:][36m=[m
[1;36m=[0m[[1;36mï¹Š[37m:[33m?[30mæ‘ƒ?[mâ•±?[1;33m?[37m:[36mï¹Š [31mAuthor[m ]|[[1m218-168-190-73.dynamic.hin[m]|[?[1;33m?[30m?[37mæ’[30m?[36mï¹Š[37m:[m][1;36m=[m
