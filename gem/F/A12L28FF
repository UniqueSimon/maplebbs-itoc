ç™¼ä¿¡äºº: guessi.bbs@bbs.wretch.cc (æ²’) çœ‹æ¿: plan
æ¨™  é¡Œ: [ä¿®æ­£] æ–‡ç« ä¸é€² All_Post çœ‹æ¿
ç™¼ä¿¡ç«™: ç„¡åå°ç«™ (2006/11/07 Tue 20:42:57)                Updated: 2006/11/07

â€» å¼•è¿°ã€Šid9455.bbs@csc241.twbbs.org (= =)ã€‹ä¹‹éŠ˜è¨€ï¼š
> é‚£è«‹å•ä¸€ä¸‹  å¦‚æžœèªªæˆ‘æƒ³è¦æ”¹æˆ
> åœ¨è¨­å®šå±¬æ€§çš„æ™‚å€™  èƒ½å¤ è¨­å®šèªªè¦ä¸è¦è®“é€™å€‹æ¿çš„æ–‡ç« é€² All_Postæ¿çš„è©±
> åˆè©²æ€Žéº¼åšå‘¢  è¬è¬æ‚¨ :)

[32m:/src/include/battr.h[m

#define BRD_ANONYMOUS   0x20    /* åŒ¿åçœ‹æ¿ */
+ #define BRD_NOALLPOST 0x40    /* ä¸åšAll_Post */

  ...
  ...

- #define NUMBATTRS       6
+ #define NUMBATTRS       7

- #define STR_BATTR       "zTcsvA"
+ #define STR_BATTR       "zTcsvAP"

[32m:/src/include/battr.h:battr_tbl[][m

  "åŒ¿åçœ‹æ¿",                   /* BRD_ANONYMOUS */
+ "ä¸é€² All_Post çœ‹æ¿"          /* BRD_NOALLPOST */


[32m:/src/so/manage.c[m

æŠŠä»¥ä¸‹é€™æ®µåŠ åœ¨ post_battr_noscore() å¾Œé¢

static int
post_battr_noallpost(xo)
  XO *xo;
{
  BRD *oldbrd, newbrd;

  oldbrd = bshm->bcache + currbno;
  memcpy(&newbrd, oldbrd, sizeof(BRD));

  switch (vans("ç™¼è¡¨æ–‡ç«  1)é€²All_Post 2)ä¸é€²All_Post [Q] "))
  {
  case '1':
    newbrd.battr &= ~BRD_NOALLPOST;
    break;
  case '2':
    newbrd.battr |= BRD_NOALLPOST;
    break;
  default:
    return XO_FOOT;
  }

  if (memcmp(&newbrd, oldbrd, sizeof(BRD)) && vans(msg_sure_ny) == 'y')
  {
    memcpy(oldbrd, &newbrd, sizeof(BRD));
    rec_put(FN_BRD, &newbrd, sizeof(BRD), currbno, NULL);
  }

  return XO_FOOT;
}

[32m:src/so/manage.c:post_manage()[m

#  ifdef HAVE_SCORE
    "Score   è¨­å®šå¯å¦è©•åˆ†",
#  endif
+   "AllPost All_Postè¨­å®š",

  ...
  ...

#  ifdef HAVE_SCORE
    " (S)è©•åˆ†"
#  endif
+   " (A)AlPo"

  ...
  ...

#ifdef HAVE_SCORE
  case 's':
    return post_battr_noscore(xo);
#endif

+ case 'a':
+   return post_battr_noallpost(xo);

[32m:/src/maple/post.c:do_post()[m

  char fpath[64], *folder, *nick, *rcpt;
  int mode;
  time_t spendtime, prev, chrono;
- BRD *brd;

  .....
  .....

  title = ve_title;
  mode = (curredit & EDIT_OUTGO) ? POST_OUTGO : 0;

#ifdef HAVE_REFUSEMARK
  if (curredit & EDIT_RESTRICT)
    mode |= POST_RESTRICT;
#endif

- brd = bshm->bcache + currbno;
- if ((brd->readlevel | brd->postlevel) < (PERM_VALID << 1))
+ if (!(currbattr & BRD_NOALLPOST))
+   do_allpost(fpath, rcpt, nick, mode);

--
[1;30;40må¤«å…µè€…ä¸ç¥¥ä¹‹å™¨ç‰©æˆ–æƒ¡ä¹‹æ•…æœ‰é“è€…ä¸è™•å›å­å±…å‰‡è²´å·¦ç”¨å…µå‰‡è²´å³å…µè€…ä¸ç¥¥ä¹‹å™¨éžå›å­[m
[1;30mä¹‹å™¨ä¸å¾—å·²[37m[30mè€Œç”¨ä¹‹æ¬æ·¡ç‚ºä¸Šå‹è€Œä¸ç¾Žè€Œç¾Žä¹‹è€…æ˜¯æ¨‚æ®ºäººå¤«æ¨‚æ®ºäººè€…å‰‡ä¸å¯å¾—å¿—æ–¼å¤©ä¸‹
[m[1;30mçŸ£å‰äº‹å°šå·¦å‡¶äº‹å°šå³åå°‡è»å±…å·¦ä¸Šå°‡è»å±…å³è¨€ä»¥å–ªç¦®è™•ä¹‹æ®ºäººä¹‹çœ¾ä»¥å“€æ‚²æ³£ä¹‹æˆ°å‹ä»¥[m
[1;30må–ªç¦®è™•ä¹‹é“å¸¸[37mç„¡å[30mæ¨¸é›–å°å¤©ä¸‹èŽ«èƒ½è‡£ä¾¯çŽ‹è‹¥èƒ½å®ˆä¹‹è¬ç‰©å°‡è‡ªè³“å¤©åœ°ç›¸åˆä»¥é™ç”˜éœ²æ°‘èŽ«[m
[1;30mä¹‹ä»¤è€Œè‡ªå‡å§‹åˆ¶æœ‰ååäº¦æ—¢æœ‰å¤«äº¦å°‡çŸ¥æ­¢çŸ¥æ­¢å¯ä»¥ä¸[37m134-208-34-179.ndhu.edu.tw[30mæµ·[m
