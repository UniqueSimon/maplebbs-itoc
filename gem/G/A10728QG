ä½œè€…: itoc (ç¶²è·¯ä¸Šçš„èŠ³é„°) çœ‹æ¿: plan
æ¨™é¡Œ: [åŠŸèƒ½] åˆ†é¡å°çµ„é•·
æ™‚é–“: 2004/04/05 Mon 11:07:00                           Updated: 2005/05/19

â€» å¼•è¿°ã€ŠEfen.bbs@backwind.g1.dorm.ncku.edu.tw (every  day...)ã€‹ä¹‹éŠ˜è¨€ï¼š
> ptt2çš„å°çµ„é•·åŠŸèƒ½æœ‰æ²’æœ‰è¾¦æ³•å¼„å‘¢
> å‡è¨­ä½ æ˜¯æŸä¸€åˆ†é¡çš„å°çµ„é•·ï¼Œ
> å°çµ„é•·å°±å¯ä»¥è‡ªè¡Œé–‹ç‰ˆï¼Œ
> ä¸¦ä¸”æŠŠç‰ˆæ”¾å…¥è‡ªå·±åˆ†é¡ä¸‹é¢çš„å­åˆ†é¡â€¦
> ä¸¦ä¸”èƒ½è¨­å®šç‰ˆçš„æ¬Šé™ï¼Œç‰ˆä¸»â€¦ç­‰
> å—¯ï¼Œå°±æ˜¯åªè¦åœ¨è©²åˆ†é¡ä¸‹ï¼Œ
> ä»–å°±ç­‰æ–¼æ˜¯ä¸€å€‹çœ‹ç‰ˆç¸½ç®¡ï¼Œ
> å‡ºäº†è©²åˆ†é¡ï¼Œä»–å°±æ˜¯å€‹ä¸€èˆ¬ä½¿ç”¨è€…äº†ï¼

: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  é€™æ˜¯å¦‚ä½•è¨­å®šå°çµ„é•·çš„èªªæ˜

  åœ¨ (A)nnouce è£¡é¢çš„ Class åŠ ä¸Šä»–çš„ IDï¼Œä»–å°±è®Šæˆå°çµ„é•·äº†
  ä¾‹å¦‚åŸæœ¬æ¨™é¡Œæ˜¯
  Personal/    åˆ†é¡ â–¡ å€‹äººå°å¤©å ‚
  æ”¹æˆ
  Personal/    [1;33må€‹äºº[m â–¡ å€‹äººå°å¤©å ‚[44m                       [1;33;40mitoc/sysop[m
  é‚£éº¼ itoc å’Œ sysop å°±è®Šæˆ Personal/ çš„å°çµ„é•·äº†
  è€Œã€Œå€‹äººã€å°±æ˜¯æœ¬å­ç›®éŒ„ä¸‹ï¼Œå°çµ„é•·æ‰€èƒ½é–‹è¨­çš„çœ‹æ¿åˆ†é¡åç¨±
  [44m  [m æ˜¯ä¸€ä¸²ç©ºç™½ï¼Œç©ºç™½å€‹æ•¸ä¸é™ï¼Œè‡³å°‘è¦ä¸€å€‹

  å°çµ„é•·æ²’æœ‰å­ç›®éŒ„ç¹¼æ‰¿
  ä¾‹å¦‚æœ‰æ¨¹ç‹€çµæ§‹
  Personal/    å€‹äºº â–¡ å€‹äººå°å¤©å ‚                       itoc
  â”œ PersonalA/   å€‹äºº â–¡ å€‹äººå°å¤©å ‚ (A)
  â”” PersonalB/   å€‹äºº â–¡ å€‹äººå°å¤©å ‚ (B)
  é‚£éº¼ itoc æ˜¯ Personal/ çš„å°çµ„é•·
  ä½†æ˜¯ä¸æ˜¯ PersonalA/ PersonalB/ çš„å°çµ„é•·

  æ‰€ä»¥å¦‚æœå¸Œæœ› itoc ä¹Ÿæ˜¯ PersonalA/ PersonalB/ çš„å°çµ„é•·ï¼Œå‰‡å¿…é ˆ
  Personal/    å€‹äºº â–¡ å€‹äººå°å¤©å ‚                       itoc
  â”œ PersonalA/   å€‹äºº â–¡ å€‹äººå°å¤©å ‚ (A)                itoc
  â”” PersonalB/   å€‹äºº â–¡ å€‹äººå°å¤©å ‚ (B)                itoc

  å°çµ„é•·åœ¨å…¶ç®¡ç†çš„åˆ†é¡ç¾¤çµ„ä¸­å¯ä»¥æŒ‰ ^P æ–°å¢çœ‹æ¿ï¼ŒæŒ‰ E ä¿®æ”¹çœ‹æ¿

  å°çµ„é•·åªèƒ½åœ¨è©²å­ç›®éŒ„é–‹æ–°çœ‹æ¿ï¼Œä¸èƒ½é–‹æ–°ç›®éŒ„
  è‹¥è¦é–‹æ–°ç›®éŒ„ï¼Œè¦ç«™é•·å¾ (A)nnounce è£¡é¢é–‹

  å°çµ„é•·ä¹Ÿçœ‹ä¸åˆ°éš±è—æ¿ï¼Œå³ä½¿æ˜¯è‡ªå·±æ‰€ç®¡ç†çš„åˆ†é¡ç¾¤çµ„ä¸‹

  å¦‚æœå°çµ„é•·æ”¹äº†æ¿åï¼Œé‚£éº¼å¾—ç”±ç«™é•·å» (A)nnounce->Class è£¡é¢æ”¹

: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

: board.c:class_newbrd()

- if (!HAS_PERM(PERM_ALLBOARD))
+ if (!is_class_manager(xo))
    return XO_NONE;

: board.c:class_edit()

static int
class_edit(xo)
  XO *xo;
{
+ int manager;

+ manager = is_class_manager(xo);
+ if (manager || HAS_PERM(PERM_BM))
- if (HAS_PERM(PERM_ALLBOARD | PERM_BM))
  {
    ...
    ...
-     if (!HAS_PERM(PERM_ALLBOARD))
+     if (!manager)
        brd_title(chn);         /* itoc.000312: æ¿ä¸»ä¿®æ”¹ä¸­æ–‡æ•˜è¿° */
      else
        brd_edit(chn);

: board.c:is_class_manager() æ–°å¢æ­¤å‡½å¼åœ¨ class_edit() å‰é¢

static int                    /* 1:æ˜¯æ­¤åˆ†é¡ç¾¤çµ„çš„å°çµ„é•· */
is_class_manager(xo)
  XO *xo;
{
  if (HAS_PERM(PERM_ALLBOARD))
    return 1;

  /* åªæœ‰çœ‹æ¿ç¸½ç®¡å¯ä»¥åœ¨çœ‹æ¿åˆ—è¡¨åŠåˆ†é¡ç¾¤çµ„ç¬¬ä¸€å±¤é–‹æ–°æ¿ */
  if (xo->key < CH_END)         /* åœ¨åˆ†é¡ç¾¤çµ„ç¬¬äºŒå±¤ä»¥ä¸‹ */
  {
    short *chx;
    char *img, *str, *list;

    img = class_img;
    chx = (short *) img + (CH_END - xo->key);
    str = img + *chx;

    /* æª¢æŸ¥æ˜¯ä¸æ˜¯æ­¤åˆ†é¡ç¾¤çµ„çš„å°çµ„é•· */
    if (list = strrchr(str + BNLEN + 1 + BCLEN + 1, ' '))
    {
      list++;
      if (is_bm(list, cuser.userid))
        return 1;
    }
  }

  return 0;
}

--
[1;37mâ–¡ æœ¬æ–‡ç« ç”± [33mitoc[37m å¾ [32mitoc.Dorm11.NCTU.edu.tw[37m ç™¼è¡¨[m
