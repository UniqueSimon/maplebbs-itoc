ä½œè€…: itoc (æ ¸å¿ƒå‹•åŠ›) ç«™å…§: itoc
æ¨™é¡Œ: Re: è«‹å•rpgå†’éšªè€…çš„æŽ’è¡Œæ¦œæ‡‰è©²æ€Žéº¼åšå‘¢???
æ™‚é–“: 2004/10/27 Wed 10:42:33                           Updated: 2004/10/27

â€» å¼•è¿°ã€Šcomfan (é›£éŽ  å‚·å¿ƒ)ã€‹ä¹‹éŠ˜è¨€ï¼š
> ç§€å‡ºç«™ä¸Šå…¨éƒ¨æœ‰åƒåŠ RPGçš„ä½¿ç”¨è€…çš„åˆ—è¡¨è³‡è¨Š
> ã€å†’éšªè€…å…¬æœƒã€‘
> ä½¿ç”¨è€…ä»£è™Ÿ   é ­éŠœ       ç¶“é©—å€¼  ç­‰ç´š é«”åŠ› é­”æ³• æˆ°åŠ› é‡‘å¹£
> allure       ä¿ å®¢       88956   9    100  100  100  0
> leechan      ç¨å­¤è€…     6767    6    100  100  100  0
> è«‹å•ä¸€ä¸‹  é‚£å€‹ç­‰ç´šå¦‚æžœæƒ³è¦æŽ’åº  ç”±ç­‰ç´šè¼ƒé«˜çš„å¾€ä¸‹æŽ’ç­‰ç´šè¼ƒä½Žçš„æ”¾åœ¨è¼ƒé«˜è€…çš„ä¸‹æ–¹

  å¾—å…ˆåšç²¾è¯å€é€™ç¯‡
  [åŠŸèƒ½] RPG æŽ’è¡Œæ¦œ

  åœ¨ (A)nnounce è£¡é¢æ–°å¢žè³‡æ–™ï¼Œè·¯å¾‘ç‚º allrpg

: toprpg.c

#define OUTFILE_RPGMAXHP BBSHOME"/gem/@/@-rpgmaxhp"
#define OUTFILE_RPGSTR   BBSHOME"/gem/@/@-rpgstr"
+ #define OUTFILE_ALLRPG BBSHOME"/gem/@/@allrpg"

: topusr.c

+ typedef struct
+ {
+   char userid[IDLEN + 1];
+   char usertitle[12];
+   int level;
+   int maxhp;
+ }      DATA2;

static DATA topmaxhp[TOPNUM];
static DATA topstr[TOPNUM];
+ static DATA2 alluserrpg[20000];    [1;44m// å‡è¨­ç«™ä¸Šä¸è¶…éŽ 20000 å€‹ id [m
+ static int allusernum = 0;

static int
sort_compare(p1, p2)
  const void *p1;
  const void *p2;
{
  DATA *a1, *a2;

  a1 = (DATA *) p1;
  a2 = (DATA *) p2;

  return (a2->num - a1->num);
}


+ static int
+ sort2_compare(p1, p2)
+   const void *p1;
+   const void *p2;
+ {
+   DATA2 *a1, *a2;
+
+   a1 = (DATA2 *) p1;
+   a2 = (DATA2 *) p2;
+   return (a2->level - a1->level);
+ }


: topusr.c:topusr()

  sprintf(fpath, "%s/"FN_RPG, acct->userid);
  if ((fd = open(fpath, O_RDONLY)) < 0)
    return;
  read(fd, &rpg, sizeof(RPG));
  close(fd);

+ strcpy(alluserrpg[allusernum].userid, acct->userid);
+ strcpy(alluserrpg[allusernum].usertitle, rpg.usertitl);
+ alluserrpg[allusernum].level = rpg.level;
+ alluserrpg[allusernum].maxhp = rpg.maxhp;
+ allusernum++;

: toprpg.c:main()

  char c;
  int year, month, day;
  time_t now;
  struct tm *ptime;
+ int i;
+ FILE *fpall;

  ...
  ...

  for (c = 'a'; c <= 'z'; c++)
  {
    ...
    ...
  }

+ qsort(alluserrpg, allusernum, sizeof(DATA2), sort2_compare);
+
+ if (fpall = fopen(OUTFILE_ALLRPG, "w"))
+ {
+   fprintf(fpall, "\033[1;44mã€å†’éšªè€…å…¬æœƒã€‘\033[m\n");
+   fprintf(fpall, "\033[30;47m%-13s%-11s%-5s%-5s \033[m\n",
+     "ä½¿ç”¨è€…ä»£è™Ÿ", "é ­éŠœ", "ç­‰ç´š", "è¡€");
+
+   for (i = 0; i < allusernum; i++)
+   {
+     fprintf(fpall, "%-13s%-11.11s%5d%5d\n",
+       alluserrpg[i].userid, alluserrpg[i].usertitle,
+       alluserrpg[i].level, alluserrpg[i].maxhp);
+   }
+
+   fclose(fpall);
+ }

--
 [1;41mâ•­[44mâ”¼[m Or[1mig[30min[m: [43m Maple-itocË™å‹•åŠ›æ ¸å¿ƒ [35;47m processor.tfcis.org [m
 [1;42mâ”¼[45mâ”˜[m A[1mut[30mho[mr: [1;31mitoc [30må¾ž [36mitoc.Dorm11.NCTU.edu.tw [30mç™¼è¡¨[m
