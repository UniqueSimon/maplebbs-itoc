ç™¼ä¿¡äºº: itoc.bbs@processor.tfcis.org (æ ¸å¿ƒå‹•åŠ›) çœ‹æ¿: plan
æ¨™  é¡Œ: Re: [å•é¡Œ]å¦‚ä½•è®“è½‰ä¿¡ç‰ˆä¹Ÿèƒ½æ“‹htmlæ–‡ç« 
ç™¼ä¿¡ç«™: å‹•åŠ›æ ¸å¿ƒ (2004/03/24 Wed 11:08:29)                Updated: 2004/06/07

â€» å¼•è¿°ã€Šckjjc (jc)ã€‹ä¹‹éŠ˜è¨€ï¼š
> å·²ç¶“æœ‰å¼„äº†ç²¾è¯å€çš„è‡ªè¨‚æ“‹ä¿¡ï¼Œä¹ŸæˆåŠŸæ“‹ä¸‹ä¸å°‘å»£å‘Šéƒµä»¶
> ä¸éæœ€è¿‘é€£ç·šæ¿ä¸Šåˆè·‘å‡ºå¾ˆå¤šhtmlçš„æ–‡ç« 
> ä¸çŸ¥é“è¦æ€éº¼æ”¹æˆèƒ½è®“è½‰ä¿¡ä¹Ÿåƒbmtadä¸€æ¨£æ“‹ä¸‹htmlçš„éƒµä»¶

: inntobbs.c

enum HeaderValue        /* æ‰€æœ‰æœ‰ç”¨åˆ°çš„ header */
{
  ...
  CONTROL_H,
+ CONTENTTYPE_H,

  LASTHEADER
};


static header_t headertable[LASTHEADER] =
{
  ...
  "Control",                    CONTROL_H,
+ "Content-Type",               CONTENTTYPE_H,
};

static char *HEADER[LASTHEADER];

char *BODY;
! char *SUBJECT, *FROM, *SITE, *DATE, *PATH,
       *GROUP, *MSGID, *CONTROL[1;33m, *CONTENTTYPE[m;


  ...
  CONTROL = HEADER[CONTROL_H];
+ CONTENTTYPE = HEADER[CONTENTTYPE_H];
}

: inntobbs.h

extern char *BODY;
! extern char *SUBJECT, *FROM, *SITE, *DATE, *PATH,
              *GROUP, *MSGID, *CONTROL,[1;33m *CONTENTTYPE[m;

: inntobbs.c:readlines();

  /* é€™äº›æ˜¯å¿…å‚™çš„æª”é ­æ¬„ä½ï¼Œåªæœ‰ CONTROL å¯ä»¥æ˜¯ NULL */
  if (!SUBJECT || !FROM || !SITE || !DATE || !PATH || !GROUP || !MSGID || !BODY)
    return -1;

+ if (CONTENTTYPE && !strstr(CONTENTTYPE, "text/plain"))
+   return 0;    /* é¨™å°æ–¹æˆ‘å·²ç¶“æ”¶éæ­¤ä¿¡äº† */

--
  æä¸å¥½é‚£äº›æœ‰ <HTML> </HTML> çš„éƒ½æ˜¯ text/plainï¼Œé‚£éº¼é€™æ‹›å°±æ²’ç”¨äº†

  é€£ç·šæ¿çš„ html å¥½åƒä¸å¤š

--
 [1;43mâ•­[46mâ”¼[m Or[1mig[30min[m: [41m Maple-itocË™å‹•åŠ›æ ¸å¿ƒ [32;47m processor.tfcis.org [m
 [1;44mâ”¼[41mâ•¯[m A[1mut[30mho[mr: [1;33mitoc [30må¾ [35mitoc.dorm11.nctu.edu.tw [30mç™¼è¡¨[m
