ç™¼ä¿¡äºº: itoc.bbs@processor.tfcis.org (:MM:) çœ‹æ¿: plan
æ¨™  é¡Œ: Re: [åŠŸèƒ½] post.c æ–‡ç« è©•åˆ†åŠŸèƒ½
ç™¼ä¿¡ç«™: XEON (Wed, 09 Apr 2003 22:26:34 +0800 (CST))      Updated: 2007/04/26

â€» å¼•è¿°ã€Šamaki.bbs@luna.twbbs.org (ä»™è‰å°ç¾Š)ã€‹ä¹‹éŠ˜è¨€ï¼š
> é¡¯ç¤ºæ–‡ç« è¢«é–±è¦½çš„æ¬¡æ•¸ç¨‹å¼å¦ï¼Ÿ

: post.c:post_browse()

#ifdef HAVE_REFUSEMARK
    if (!chkrestrict(hdr))
      break;
#endif

+   hdr->numread++;
+   currchrono = hdr->chrono;
+   rec_put(dir, hdr, sizeof(HDR), pos, cmpchrono);

    hdr_fpath(fpath, dir, hdr);

    /* Thor.990204: ç‚ºè€ƒæ…®more å‚³å›å€¼ */
    if ((key = more(fpath, FOOTER_POST)) < 0)
      break;

: hdr.h:struct HDR

  char owner[80];               /* ä½œè€… (E-mail address) */
- char nick[49];                /* æš±ç¨± */
+ char nick[44];                /* æš±ç¨± */
+ int numread;                  /* è¢«é–±è®€éå¹¾æ¬¡ */
+ char nouse;
  char score;                   /* æ–‡ç« è©•æ¯”åˆ†æ•¸ */

  char date[9];                 /* 96/12/31 */
  char title[73];

: post.c:post_item() æ’ç‰ˆè‡ªå®š

static void
post_item(num, hdr)
  int num;
  HDR *hdr;
{
+ int numread;

  ...
  ...

- prints("%6d%c%c", (hdr->xmode & POST_BOTTOM) ? -1 : num,
-   tag_char(hdr->chrono), post_attr(hdr));
+ numread = hdr->numread / 1000;     /* æ¯ä¸€åƒæ¬¡ç€è¦½ç®—ä¸€åˆ† */
+ prints("%6d%c%c%c", (hdr->xmode & POST_BOTTOM) ? -1 : num,
+   tag_char(hdr->chrono), post_attr(hdr),
+   numread ? '0' + numread : ' ');

  ...
  ...

- hdr_outs(hdr, d_cols + 46);
+ hdr_outs(hdr, d_cols + 45);

  ...
  ...

- prints("%6d%c%c", (hdr->xmode & POST_BOTTOM) ? -1 : num,
-   tag_char(hdr->chrono), post_attr(hdr));
- hdr_outs(hdr, d_cols + 47);
+ numread = hdr->numread / 1000;     /* æ¯ä¸€åƒæ¬¡ç€è¦½ç®—ä¸€åˆ† */
+ prints("%6d%c%c%c", (hdr->xmode & POST_BOTTOM) ? -1 : num,
+   tag_char(hdr->chrono), post_attr(hdr),
+   numread ? '0' + numread : ' ');
+ hdr_outs(hdr, d_cols + 46);
}

--
  åœ¨ web ä¸­å¤§å®¶ä¸¦ä¸å¾ªåºé–±è®€ï¼Œæ‰€ä»¥é»é–±æ¬¡æ•¸æœ‰ä¸€å®šçš„åƒè€ƒåƒ¹å€¼
  ç„¶è€Œåœ¨ bbs ä¸Šå¤§å®¶éƒ½æ˜¯ä¸€ç¯‡ä¸€ç¯‡å¾ªåºé–±è®€
  æ‰€ä»¥é»é–±æ¬¡æ•¸è®Šçš„ä¸æ€éº¼æœ‰åƒè€ƒåƒ¹å€¼
  (ä¹Ÿè¨±åœ¨ç²¾è¯å€ä¸­æœƒæœ‰åƒ¹å€¼ï¼Œä½†æ˜¯çœ‹æ¿ä¸­ä¸æœƒ)

--
    [1;32mâ•­â”€ Origin â”€â•— [0;36m?[1m?[0;36m?[1mO[0;36m?[1m?[0;36m?[1m?[1;31m processor.tfcis.org [32m ï½ ÎºÎ»Î¼ â”€â”¤[m
    [1;32mâ”œ   Author   â•¡ [33;44mitoc.dorm-gd2.nctu.edu.tw                [m
