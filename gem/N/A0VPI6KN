ç™¼ä¿¡äºº: itoc.bbs@xeon.tfcis.org (æ ¸å¿ƒå‹•åŠ›) çœ‹æ¿: plan
æ¨™  é¡Œ: Re: é–æ–‡Ctrl+y
ç™¼ä¿¡ç«™: å‹•åŠ›æ ¸å¿ƒ (Fri, 24 Oct 2003 18:36:01 +0800 (CST))  Updated: 2007/04/26

â€» å¼•è¿°ã€Šuserjoe.bbs@bittern.csie.nctu.edu.tw (ç´…é¾)ã€‹ä¹‹éŠ˜è¨€ï¼š
> é–æ–‡åœ¨æ–‡ç« æ¨™é¡Œæ”¹æˆ"æ–‡ç« å·²è¢«ç«™å‹™äººå“¡é–ä½"

: post.c:hdr_outs() ä¸é¡¯ç¤ºä½œè€…

  /* --------------------------------------------------- */
  /* å°å‡ºä½œè€…                                            */
  /* --------------------------------------------------- */

#ifdef CHECK_ONLINE
  if (online = utmp_seek(hdr))
    outs(COLOR7);
#endif

+#ifdef HAVE_REFUSEMARK
+ if (!chkrestrict(hdr))
+   mark = "ä½œè€…åŠ å¯†";
+ else
+#endif
    mark = hdr->owner;
  len = IDLEN + 1;

: post.c:hdr_outs() ä¸é¡¯ç¤ºæ¨™é¡Œ

  /* --------------------------------------------------- */
  /* å°å‡ºæ¨™é¡Œçš„ç¨®é¡                                      */
  /* --------------------------------------------------- */

+#ifdef HAVE_REFUSEMARK
+ if (!chkrestrict(hdr))
+ {
+   title = "æ–‡ç« å·²è¢«ç«™å‹™äººå“¡é–ä½";
+   ch = 1;
+ }
+ else
+#endif
+ {
    title = str_ttl(mark = hdr->title);
    ch = title == mark;
    if (!strcmp(currtitle, title))
      ch += 2;
+ }

: cache.c:utmp_seek() å¯†æ–‡ä½œè€…ä¸é¡¯ç¤ºåœ¨ç·šä¸Š

  if (hdr->xmode & POST_INCOME) /* POST_INCOME å’Œ MAIL_INCOME æ˜¯ç›¸åŒçš„ */
    return NULL;
+#ifdef HAVE_REFUSEMARK
+ if (!chkrestrict(hdr))
+   return NULL;
+#endif
  return utmp_get(hdr->owner);

: xover.c:xo_uquery() ä¸èƒ½ ^Q æŸ¥è©¢å¯†æ–‡ä½œè€…

  hdr = (HDR *) xo_pool + (xo->pos - xo->top);
+#ifdef HAVE_REFUSEMARK
+ if (!chkrestrict(hdr))
+   return XO_NONE;
+#endif
  userid = hdr->owner;
  if (strchr(userid, '.'))
    return XO_NONE;

: bhttpd.c::postlist_list()

 if (brdname)
   fprintf(fpw, "  <td><a href=/bmore?%s&%d>", brdname, i);
 else
   fprintf(fpw, "  <td><a href=/mmore?%d&>", i);

+ #ifdef HAVE_REFUSEMARK
+     fprintf(fpw, "%s</td>\n</tr>\n",
+       (hdr.xmode & POST_RESTRICT) ? "<è³‡æ–™ä¿å¯†>" : str_html(hdr.title, 50));
+ #else
      fprintf(fpw, "%s</td>\n</tr>\n", str_html(hdr.title, 50));
+ #endif

: post.c:post_cross() åŠ å¯†æ–‡ç« ä¸å¾—è½‰éŒ„

    hdr = tag ? &xhdr : (HDR *) xo_pool + (xo->pos - xo->top);
      /* lkchu.981201: æ•´æ‰¹è½‰éŒ„ */

+   if ((!tag) && (hdr->xmode & POST_RESTRICT))
+   {
+     vmsg("åŠ å¯†æ–‡ç« ä¸å¾—è½‰éŒ„");
+     return XO_HEAD;
+   }

--
 [1;43mâ”Œ[44mâ”¼[m Or[1mig[30min[m: [44m å°å—ä¸€ä¸­Ë™å‹•åŠ›æ ¸å¿ƒ [31;47m processor.tfcis.org [m
 [1;41mâ””[42mâ”˜[m A[1mut[30mho[mr: [1;36mitoc [30må¾ [35mpc512-2.ee.nctu.edu.tw [30mç™¼è¡¨[m
