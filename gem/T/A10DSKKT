ç™¼ä¿¡äºº: itoc.bbs@processor.tfcis.org (æ ¸å¿ƒå‹•åŠ›) çœ‹æ¿: plan
æ¨™  é¡Œ: Re: [å•é¡Œ] è«‹å•å¦‚ä½•å¤šä¸€çµ„class(é¡ä¼¼WindTopå°ˆæ¥­è¨è«–å€)
ç™¼ä¿¡ç«™: å‹•åŠ›æ ¸å¿ƒ (2004/06/27 Sun 10:59:29)                Updated: 2004/06/27

â€» å¼•è¿°ã€ŠLandRover (å¤§åœ°è‹±è±ª)ã€‹ä¹‹éŠ˜è¨€ï¼š
> æ”¹ç‚ºitocä»¥å¾Œã€€å¸Œæœ›ä»èƒ½åœ¨ä¸»é¸å–®åšä¸€å€‹ã€Œå°ˆæ¥­è¨è«–å€ã€

  åœ¨ (A)nnounce è£¡é¢é–‹å€‹åˆ†é¡å« PROF å³å¯

: struct.h

#define CLASS_IMGFILE_NAME      "run/classname.img"
#define CLASS_IMGFILE_TITLE     "run/classtitle.img"
+ #define CLASS_IMGFILE_PROF    "run/classprof.img"

: account.c:class_image()

static void
class_image()
{
  int i, times;
  FILE *fp;
  short len, pos[CH_MAX];
  ClassHeader *chp;

- for (times = 2; times > 0; times--)
+ for (times = 3; times > 0; times--)
  {
    chn = 0;
    class_sort(times == 1 ? brdname_cmp : brdtitle_cmp);
-   class_parse(CLASS_INIFILE);
+   class_parse(times == 3 ? "PROF" : CLASS_INIFILE);

    ...
    ...

-     rename(CLASS_RUNFILE, times == 1 ? CLASS_IMGFILE_NAME :
-       CLASS_IMGFILE_TITLE);
+     rename(CLASS_RUNFILE, times == 1 ? CLASS_IMGFILE_NAME :
+       times == 2 ? CLASS_IMGFILE_TITLE : CLASS_IMGFILE_PROF);
    }
  }

  class_chn();
}

: board.c

static char *class_img = NULL;
static XO board_xo;
+ static int class_prof;        /* åœ¨ 1:Profession 0:Class è£¡é¢ */

: board.c:board_main()

- class_img = f_img(cuser.ufo & UFO_BRDNAME ? CLASS_IMGFILE_NAME :
-   CLASS_IMGFILE_TITLE, &fsize);
+ class_img = f_img(class_prof ? CLASS_IMGFILE_PROF :
+   cuser.ufo & UFO_BRDNAME ? CLASS_IMGFILE_NAME : CLASS_IMGFILE_TITLE,
+   &fsize);

: board.c:class_namemode()

static int
class_namemode(xo)              /* itoc.010413: çœ‹æ¿ä¾ç…§å­—æ¯/åˆ†é¡æ’åˆ— */
  XO *xo;
{
  static time_t last = 0;
  time_t now;

+ if (class_prof)
+   return XO_NONE;

: board.c:Class()

int
Class()
{
+ if (class_prof)
+ {
+   class_prof = 0;
+   if (cuser.userlevel)
+     brh_save();
+   board_main();
+ }
  /* XoClass(CH_END - 1); */
  /* Thor.980804: é˜²æ­¢ æœªç”¨ account é€ å‡º class.img æˆ–æ²’æœ‰ class çš„æƒ…æ³ */
  if (!class_img || !XoClass(CH_END - 1))
  {
    vmsg("æœªå®šç¾©åˆ†çµ„è¨è«–å€");
    return XEASY;
  }
  return 0;
}

: board.c:Profession() æ–°å¢æ­¤å‡½å¼åœ¨ Class() å¾Œé¢

int
Profession()
{
  if (!class_prof)
  {
    class_prof = 1;
    if (cuser.userlevel)
      brh_save();
    board_main();
  }
  /* XoClass(CH_END - 1); */
  /* Thor.980804: é˜²æ­¢ æœªç”¨ account é€ å‡º class.img æˆ–æ²’æœ‰ class çš„æƒ…æ³ */
  if (!class_img || !XoClass(CH_END - 1))
  {
    vmsg("æœªå®šç¾©åˆ†çµ„è¨è«–å€");
    return XEASY;
  }
  return 0;
}

: maple.p

int Class(void);
+ int Profession(void);

: menu.c:menu_main[]

  Class, 0, M_BOARD,
  "Class     Ï† åˆ†çµ„è¨è«–é›† Ï†",

+ Profession, 0, M_BOARD,
+ "ProfessionÏ† å°ˆæ¥­è¨è«–é›† Ï†",


--
 [1;41mâ•­[44mâ”¼[m Or[1mig[30min[m: [43m Maple-itocË™å‹•åŠ›æ ¸å¿ƒ [35;47m processor.tfcis.org [m
 [1;42mâ”¼[45mâ”˜[m A[1mut[30mho[mr: [1;31mitoc [30må¾ [36mitoc.Dorm11.NCTU.edu.tw [30mç™¼è¡¨[m
