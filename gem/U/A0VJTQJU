ä½œè€…: itoc (worm.twbbs.org) ç«™å…§: plan
æ¨™é¡Œ: [åŠŸèƒ½] find_title.c æœå°‹æ‰€æœ‰æ–‡ç« æ¨™é¡Œ
æ™‚é–“: Wed Aug 28 01:27:24 2002                          Updated: 2005/05/19

  æŠŠå…¨ç«™çœ‹æ¿çš„æ–‡ç« æ¨™é¡Œéƒ½æœå°‹ä¸€é

: src/util/Makefile åŠ å…¥ find_title

EXE =   ... [1;33mfind_title[m

: src/util/find_title.c æ–°å¢ç¨‹å¼å¦‚ä¸‹

/*-------------------------------------------------------*/
/* util/find_title.c    ( NTHU CS MapleBBS Ver 3.10 )    */
/*-------------------------------------------------------*/
/* target : æœå°‹æ‰€æœ‰çœ‹æ¿å…¨éƒ¨æ–‡ç« æ¨™é¡Œ                     */
/* create : 03/04/26                                     */
/* update : 05/05/19                                     */
/* author : itoc.bbs@bbs.tnfsh.tn.edu.tw                 */
/*-------------------------------------------------------*/


#include "bbs.h"


static char *keyword;


static void
do_find(brdname)
  char *brdname;
{
  int i, fsize;
  char folder[64];
  HDR *hdr;

  printf("é–‹å§‹æœå°‹ %s æ¿\n", brdname);

  brd_fpath(folder, brdname, FN_DIR);
  if (hdr = (HDR *) f_img(folder, &fsize))
  {
    fsize /= sizeof(HDR);
    for (i = 0; i < fsize; i++)
    {
      if (strstr(hdr[i].title, keyword))
        printf("[%s] %s\n", brdname, hdr[i].title);
    }

    free(hdr);
  }
}


int
main(argc, argv)
  int argc;
  char *argv[];
{
  int num;
  BRD brd;

  if (argc != 2)
  {
    printf("%s keyword\n", argv[0]);
    return 0;
  }

  chdir(BBSHOME);

  keyword = argv[1];

  num = 0;
  while (!rec_get(FN_BRD, &brd, sizeof(BRD), num))
  {
    if (*brd.brdname)
      do_find(brd.brdname);
    num++;
  }
  printf("æ‰¾å®Œæ‰€æœ‰çœ‹æ¿\n");

  return 0;
}

--
[1;37mâ–¡ æœ¬æ–‡ç« ç”± [33mitoc[37m å¾ [32mitoc.Dorm-GD2.NCTU.edu.tw[37m ç™¼è¡¨[m
